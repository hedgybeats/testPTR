{"version":3,"sources":["./src/app/admin/views/addUser/add-user-routing.module.ts","./src/app/admin/views/addUser/add-user.component.ts","./src/app/admin/views/addUser/add-user.component.html","./src/app/admin/views/addUser/add-user.module.ts","./src/app/admin/views/addUser/index.ts"],"names":[],"mappings":"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","file":"views-addUser.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { AddUserComponent } from './add-user.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: AddUserComponent,\r\n    data: {\r\n      title: 'Add User'\r\n    }\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class AddUserRoutingModule {}","import { ToastService } from './../../../_services/_toast/_toast.service';\r\nimport { UserRole } from './../../../enums/enums';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { Constants } from '../../../constants';\r\nimport { DbService, UserService } from '../../../_services';\r\nimport { DialogService } from '../../../_services';\r\n\r\n@Component({\r\n  templateUrl: './add-user.component.html',\r\n  styleUrls: ['./add-user.component.css'],\r\n})\r\nexport class AddUserComponent implements OnInit {\r\n  constructor(\r\n    public constants: Constants,\r\n    private formBuilder: FormBuilder,\r\n    private userService: UserService,\r\n    private dialogService: DialogService,\r\n    private db: DbService,\r\n    private toastService: ToastService\r\n  ) {}\r\n\r\n  error: any;\r\n  userForm: FormGroup;\r\n  businesses: any[];\r\n  userRoleSelected = true;\r\n\r\n  ngOnInit() {\r\n    this.InitForm();\r\n    this.getBusinesses();\r\n  }\r\n\r\n  public onRoleChange(event) {\r\n    if (event.value) {\r\n      this.userRoleSelected = event.value === UserRole.User ? true : false;\r\n      if (this.userRoleSelected) {\r\n        this.userForm.get('businessIds').enable();\r\n      } else {\r\n        this.userForm.get('businessIds').disable();\r\n      }\r\n    }\r\n  }\r\n\r\n  private async getBusinesses(): Promise<void> {\r\n    this.businesses = await this.db.getBusinesses();\r\n  }\r\n\r\n  private InitForm() {\r\n    this.userForm = this.formBuilder.group({\r\n      username: [[], [Validators.required]],\r\n      password: [[], [Validators.required]],\r\n      userRole: [UserRole.User, [Validators.required]],\r\n      businessIds: [{ value: [], disabled: false }, [Validators.required]],\r\n    });\r\n  }\r\n\r\n  get username() {\r\n    return this.userForm.get('username').value;\r\n  }\r\n  get password() {\r\n    return this.userForm.get('password').value;\r\n  }\r\n  get userRole() {\r\n    return this.userForm.get('userRole').value;\r\n  }\r\n  get businessIds() {\r\n    return this.userForm.get('businessIds').value;\r\n  }\r\n\r\n  public TryAddUser() {\r\n    if (this.userForm.valid) {\r\n      this.AddUser();\r\n    } else {\r\n      this.toastService.showError('Missing required fields');\r\n      this.userForm.markAllAsTouched();\r\n    }\r\n  }\r\n\r\n  public async AddUser() {\r\n    let user;\r\n    if (this.userRole === UserRole.User) {\r\n      user = {\r\n        username: this.username,\r\n        passwordHash: undefined,\r\n        userRole: this.userRole,\r\n        businessIds: this.businessIds,\r\n      };\r\n    } else if (this.userRole === UserRole.Admin) {\r\n      user = {\r\n        username: this.username,\r\n        passwordHash: undefined,\r\n        userRole: this.userRole,\r\n      };\r\n    }\r\n    try {\r\n      await this.userService.CreateUser(user, this.password);\r\n      this.toastService.showSuccess(`User '${user.username}' created successfully`);\r\n    } catch (err) {\r\n      this.handleError(err);\r\n    }\r\n  }\r\n\r\n  private handleError(error): void {\r\n    this.toastService.showError(error);\r\n  }\r\n}\r\n","<mat-card class=\"main-content-card\">\r\n  <h1>Add user component</h1>\r\n  <form [formGroup]=\"userForm\">\r\n    <div class=\"d-flex w-100 justify-content-between\">\r\n      <div class=\"d-flex w-50\">\r\n        <mat-form-field appearance=\"fill\" class=\"w-100 pt-2 ps-2 pe-2\">\r\n          <mat-label>Username</mat-label>\r\n          <input matInput type=\"text\" formControlName=\"username\" />\r\n        </mat-form-field>\r\n      </div>\r\n      <div class=\"d-flex w-50\">\r\n        <mat-form-field appearance=\"fill\" class=\"w-100 pt-2 ps-2 pe-2\">\r\n          <mat-label>Password</mat-label>\r\n          <input matInput type=\"text\" formControlName=\"password\" />\r\n        </mat-form-field>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex w-50 justify-content-between\">\r\n      <div class=\"d-flex w-50\">\r\n        <mat-form-field appearance=\"fill\" class=\"w-100 p-1\">\r\n          <mat-label>Role</mat-label>\r\n          <mat-select\r\n            (selectionChange)=\"onRoleChange($event)\"\r\n            formControlName=\"userRole\"\r\n          >\r\n            <mat-option\r\n              *ngFor=\"let role of constants.userRoles\"\r\n              [value]=\"role.value\"\r\n            >\r\n              {{ role.viewValue }}\r\n            </mat-option>\r\n          </mat-select>\r\n        </mat-form-field>\r\n      </div>\r\n      <div class=\"d-flex w-50\" *ngIf=\"userRoleSelected\">\r\n        <mat-form-field appearance=\"fill\" class=\"w-100 p-1\">\r\n          <mat-label>Business</mat-label>\r\n          <mat-select formControlName=\"businessIds\" multiple>\r\n            <mat-option\r\n              *ngFor=\"let business of businesses\"\r\n              [value]=\"business.id\"\r\n            >\r\n              {{ business.name }}\r\n            </mat-option>\r\n          </mat-select>\r\n        </mat-form-field>\r\n      </div>\r\n    </div>\r\n  </form>\r\n  <button mat-raised-button (click)=\"TryAddUser()\">Add User</button>\r\n</mat-card>\r\n","import { NgModule } from '@angular/core';\r\nimport { AddUserRoutingModule } from './add-user-routing.module';\r\nimport { AngularMaterialModule } from '../../../angular-material.module';\r\nimport { CommonModule } from \"@angular/common\";\r\nimport { FormsModule, ReactiveFormsModule} from '@angular/forms';\r\nimport { AddUserComponent } from './add-user.component';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { DialogService } from '../../../_services/_dialog/_dialog.service';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddUserComponent\r\n  ],\r\n  imports: [\r\n    AddUserRoutingModule,\r\n    AngularMaterialModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    HttpClientModule,\r\n    CommonModule\r\n  ],\r\n  providers: [DialogService]\r\n})\r\nexport class AddUserModule { }\r\n","export * from './add-user.component';\r\nexport * from './add-user-routing.module';\r\nexport * from './add-user.module';"],"sourceRoot":"webpack:///"}