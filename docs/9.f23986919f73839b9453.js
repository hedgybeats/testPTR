(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"b/M6":function(e,s,t){"use strict";t.r(s),t.d(s,"AddUserComponent",function(){return g}),t.d(s,"AddUserRoutingModule",function(){return y}),t.d(s,"AddUserModule",function(){return q});var r=t("mrSG"),i=t("VzXK"),o=t("3Pt+"),n=t("fXoL"),u=t("U7T7"),a=t("J9tS"),c=t("8I6g"),d=t("Wp6s"),l=t("kmnG"),b=t("qFsG"),m=t("d3UM"),f=t("ofXK"),h=t("bTqV"),p=t("FKr1");function v(e,s){if(1&e&&(n.Ub(0,"mat-option",13),n.Kc(1),n.Tb()),2&e){const e=s.$implicit;n.qc("value",e.value),n.Bb(1),n.Mc(" ",e.viewValue," ")}}function U(e,s){if(1&e&&(n.Ub(0,"mat-option",13),n.Kc(1),n.Tb()),2&e){const e=s.$implicit;n.qc("value",e.id),n.Bb(1),n.Mc(" ",e.name," ")}}function w(e,s){if(1&e&&(n.Ub(0,"div",3),n.Ub(1,"mat-form-field",8),n.Ub(2,"mat-label"),n.Kc(3,"Business"),n.Tb(),n.Ub(4,"mat-select",14),n.Ic(5,U,2,2,"mat-option",10),n.Tb(),n.Tb(),n.Tb()),2&e){const e=n.jc();n.Bb(5),n.qc("ngForOf",e.businesses)}}let g=(()=>{class e{constructor(e,s,t,r,i,o){this.constants=e,this.formBuilder=s,this.userService=t,this.dialogService=r,this.db=i,this.toastService=o,this.userRoleSelected=!0}ngOnInit(){this.InitForm(),this.getBusinesses()}onRoleChange(e){e.value&&(this.userRoleSelected=e.value===i.f.User,this.userRoleSelected?this.userForm.get("businessIds").enable():this.userForm.get("businessIds").disable())}getBusinesses(){return Object(r.a)(this,void 0,void 0,function*(){this.businesses=yield this.db.getBusinesses()})}InitForm(){this.userForm=this.formBuilder.group({username:[[],[o.w.required]],password:[[],[o.w.required]],userRole:[i.f.User,[o.w.required]],businessIds:[{value:[],disabled:!1},[o.w.required]]})}get username(){return this.userForm.get("username").value}get password(){return this.userForm.get("password").value}get userRole(){return this.userForm.get("userRole").value}get businessIds(){return this.userForm.get("businessIds").value}TryAddUser(){this.userForm.valid?this.AddUser():(this.toastService.showError("Missing required fields"),this.userForm.markAllAsTouched())}AddUser(){return Object(r.a)(this,void 0,void 0,function*(){let e;this.userRole===i.f.User?e={username:this.username,passwordHash:void 0,userRole:this.userRole,businessIds:this.businessIds}:this.userRole===i.f.Admin&&(e={username:this.username,passwordHash:void 0,userRole:this.userRole});try{yield this.userService.CreateUser(e,this.password),this.toastService.showSuccess(`User '${e.username}' created successfully`)}catch(s){this.handleError(s)}})}handleError(e){this.toastService.showError(e)}}return e.\u0275fac=function(s){return new(s||e)(n.Ob(u.a),n.Ob(o.e),n.Ob(a.c),n.Ob(a.b),n.Ob(a.a),n.Ob(c.a))},e.\u0275cmp=n.Ib({type:e,selectors:[["ng-component"]],decls:25,vars:3,consts:[[1,"main-content-card"],[3,"formGroup"],[1,"d-flex","w-100","justify-content-between"],[1,"d-flex","w-50"],["appearance","fill",1,"w-100","pt-2","ps-2","pe-2"],["matInput","","type","text","formControlName","username"],["matInput","","type","text","formControlName","password"],[1,"d-flex","w-50","justify-content-between"],["appearance","fill",1,"w-100","p-1"],["formControlName","userRole",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","d-flex w-50",4,"ngIf"],["mat-raised-button","",3,"click"],[3,"value"],["formControlName","businessIds","multiple",""]],template:function(e,s){1&e&&(n.Ub(0,"mat-card",0),n.Ub(1,"h1"),n.Kc(2,"Add user component"),n.Tb(),n.Ub(3,"form",1),n.Ub(4,"div",2),n.Ub(5,"div",3),n.Ub(6,"mat-form-field",4),n.Ub(7,"mat-label"),n.Kc(8,"Username"),n.Tb(),n.Pb(9,"input",5),n.Tb(),n.Tb(),n.Ub(10,"div",3),n.Ub(11,"mat-form-field",4),n.Ub(12,"mat-label"),n.Kc(13,"Password"),n.Tb(),n.Pb(14,"input",6),n.Tb(),n.Tb(),n.Tb(),n.Ub(15,"div",7),n.Ub(16,"div",3),n.Ub(17,"mat-form-field",8),n.Ub(18,"mat-label"),n.Kc(19,"Role"),n.Tb(),n.Ub(20,"mat-select",9),n.fc("selectionChange",function(e){return s.onRoleChange(e)}),n.Ic(21,v,2,2,"mat-option",10),n.Tb(),n.Tb(),n.Tb(),n.Ic(22,w,6,1,"div",11),n.Tb(),n.Tb(),n.Ub(23,"button",12),n.fc("click",function(){return s.TryAddUser()}),n.Kc(24,"Add User"),n.Tb(),n.Tb()),2&e&&(n.Bb(3),n.qc("formGroup",s.userForm),n.Bb(18),n.qc("ngForOf",s.constants.userRoles),n.Bb(1),n.qc("ngIf",s.userRoleSelected))},directives:[d.a,o.y,o.p,o.i,l.b,l.e,b.b,o.c,o.o,o.h,m.a,f.k,f.l,h.a,p.k],styles:[""]}),e})();var T=t("tyNb");const I=[{path:"",component:g,data:{title:"Add User"}}];let y=(()=>{class e{}return e.\u0275mod=n.Mb({type:e}),e.\u0275inj=n.Lb({factory:function(s){return new(s||e)},imports:[[T.f.forChild(I)],T.f]}),e})();var R=t("rhD1"),F=t("tk/3"),S=t("25yu");let q=(()=>{class e{}return e.\u0275mod=n.Mb({type:e}),e.\u0275inj=n.Lb({factory:function(s){return new(s||e)},providers:[S.a],imports:[[y,R.a,o.k,o.u,F.b,f.c]]}),e})()}}]);